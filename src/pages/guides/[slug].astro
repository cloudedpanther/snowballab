---
import Layout from '../../layouts/Layout.astro';
import { getCollection, render } from 'astro:content';
import { withBase } from '../../utils/paths';

export async function getStaticPaths() {
  const entries = await getCollection('guides');
  return entries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const base = import.meta.env.BASE_URL;
const { Content } = await render(entry);
---

<Layout
  title={`${entry.data.title} · Snowballlab`}
  description={entry.data.description}
  canonical={withBase(base, `/guides/${entry.id}/`)}
>
  <article class="space-y-6">
    <header>
      <h1 class="text-2xl font-semibold text-slate-900 dark:text-white md:text-3xl">
        {entry.data.title}
      </h1>
      <p class="mt-2 text-slate-600 dark:text-slate-300">{entry.data.description}</p>
    </header>
    <div
      class="prose prose-slate dark:prose-invert max-w-none rounded-2xl border border-slate-200 bg-white/80 p-6 dark:border-slate-800 dark:bg-slate-900/40"
    >
      <Content />
    </div>
    <p class="text-sm text-slate-500 dark:text-slate-400">
      <a href={withBase(base, '/guides/')} class="hover:text-slate-700 dark:hover:text-slate-300"
        >← 가이드 목록</a
      >
    </p>
  </article>
</Layout>
